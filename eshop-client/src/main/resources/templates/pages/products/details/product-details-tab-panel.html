<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<body>
	<th:block th:fragment="product-details-tab-panel">
		<ul class="nav nav-tabs" id="productTabs" role="tablist">
			<li class="nav-item">
				<a class="nav-link active" id="descriptionTab" href="#description"
					data-toggle="tab" role="tab" aria-controls="description" aria-selected="true">
					<span th:text="#{msg.common.description}">Description</span>	
				</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" id="attributesTab" href="#attributes"
				 	data-toggle="tab" role="tab" aria-controls="attributes" aria-selected="false">
				 	<span th:text="#{msg.common.attributes}">Attributes</span>
				 </a>
			</li>
			<li class="nav-item">
				<a class="nav-link" id="commentsTab" href="#comments"
				 	data-toggle="tab" role="tab" aria-controls="comments" aria-selected="false">
				 	<span th:text="|#{msg.common.comments} (${#lists.size(product.comments)})|">Comments</span>	
				 </a>
			</li>
		</ul>
		<div class="tab-content" id="productTabsContent">
			<div class="tab-pane fade show active" id="description" role="tabpanel" aria-labelledby="descriptionTab">
				<div th:if="${product.descriptionFull != null}" th:utext="${product.descriptionFull}">Description</div>
				<div th:unless="${product.descriptionFull != null}" th:text="#{msg.common.noDescription}"></div>
			</div>
			<div class="tab-pane fade" id="attributes" role="tabpanel" aria-labelledby="attributesTab">
				<div class="row">
					<div class="col-12 col-md-10 col-lg-10">
						<p th:unless="${product.attributes}" class="mt-4" th:text="#{msg.common.noInfo}"></p>
						<table th:if="${product.attributes}" class="table table-striped table-sm">
							<tbody th:each="group : ${product.attributes}">
								<tr>
									<th scope="col" colspan="2">
										<span th:text="${group.key}"></span>
									</th>
								</tr>
								<tr th:each="attr: ${group.value}">
									<td style="width: 50%"><span th:text="${attr.key}"></span></td>
									<td><span th:text="${#strings.isEmpty(#messages.msgOrNull(attr.value)) ? attr.value : #messages.msg(attr.value)}"></span></td>
								</tr>
							</tbody>
						</table>							
					</div>
				</div>
			</div>
			<div class="tab-pane fade" id="comments" role="tabpanel" aria-labelledby="commentsTab">
				<button type="button" class="btn btn-success mt-4 mb-4"
					data-toggle="collapse" data-target="#addComment" role="button" aria-expanded="false" aria-controls="addComment">
					[[#{msg.common.addComment}]]	
				</button>
				<div id="addComment" class="col-md-6 card collapse">
				  	<div class="card-body">
				  		<form id="addCommentForm">
				  			<div class="form-group">
							    <label for="name" class="font-weight-bold">Name</label>
							    <input type="text" name="name" class="form-control form-control-sm" id="addCommentName">
							</div>
							<div class="form-group">
							    <label for="addCommentEmail" class="font-weight-bold">E-mail</label>
							    <input type="text" name="email" class="form-control form-control-sm" id="addCommentEmail">
							</div>
							<div class="form-group">
							    <label for="addCommentText" class="font-weight-bold">Comment</label>
							    <textarea name="text" class="form-control form-control-sm" id="addCommentText"></textarea>
							</div>
					    	<button type="button" class="btn btn-success mt-4">
								[[#{msg.common.addComment}]]	
							</button>
					    </form>
				  	</div>
				</div>
				<div th:if="${#lists.isEmpty(product.comments)}">
					<p th:text="#{msg.common.noComments}"></p>
				</div>
				<div th:unless="${#lists.isEmpty(product.comments)}" class="list-group small">
					<div th:each="comment : ${product.comments}" class="list-group-item">
				 		<div class="row">
				 			<div class="col-6 text-left">
				 				<div>
				 					<span class="fa fa-user fa-xs"></span>
									<span class="font-weight-bold mr-4">[[${comment.name}]]</span>
								</div>
								<span th:replace="components/rating :: rating(name = ${comment.id}, value = ${comment.mark})">Rating</span>
				 			</div>
				 			<div class="col-6 text-right">
				 				<span class="fa fa-calendar fa-xs"></span>
				 				<span class="font-weight-italic">[[${#temporals.format(comment.date, 'yyyy-MM-dd hh:mm:ss')}]]</span>	
				 			</div>
				 			<div class="col-12">
				 				<span>[[${comment.text}]]</span>
				 			</div>
		 				</div>
			 		</div>
				</div>
			</div>
		</div>
	</th:block>
</body>
</html>