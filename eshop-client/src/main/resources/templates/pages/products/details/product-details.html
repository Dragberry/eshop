<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/template-with-breadcrumb}">
<head>
	<title th:text="${product.tagTitle != null ? product.tagTitle : product.title}">Product title</title>
	<meta name="keywords" th:content="${product.tagKeywords}">
	<meta name="description" th:content="${product.tagDescription}">
	<meta name="product-id" th:content="${product.id}">
</head>
	<th:block layout:fragment="main-content">
		<div class="container">
			<h1 class="d-inline">[[${product.title}]]</h1>
			<div class="row mt-4">
				<div class="col-md-6">
					<div class="card">
						<div id="productCarouselIndicators" class="carousel slide" data-ride="carousel">
						  	<div class="carousel-inner">
							    <div class="carousel-item active">
							    	<img class="d-block w-100" th:title="${product.title}" th:alt="${product.title}"
							    		th:src="${product.mainImage} ? @{|${@environment.getProperty('url.images')}/${product.id}/${product.article}/${product.mainImage}|} : ${@environment.getProperty('url.no-image')}">
							    </div>
							    <div th:each="img,iter : ${product.images}" class="carousel-item">
							    	<img class="d-block w-100" th:title="${product.title}" th:alt="${product.title}"
							    		th:src="@{|${@environment.getProperty('url.images')}/${product.id}/${product.article}/${img}|}">
							    </div>
							</div>
							<a class="carousel-control-prev" href="#productCarouselIndicators" role="button" data-slide="prev">
								<span class="carousel-control-prev-icon" aria-hidden="true"></span>
						    	<span class="sr-only">Previous</span>
							</a>
							<a class="carousel-control-next" href="#productCarouselIndicators" role="button" data-slide="next">
							    <span class="carousel-control-next-icon" aria-hidden="true"></span>
							    <span class="sr-only">Next</span>
							</a>
						</div>
						<div class="carousel-thumbnails-wrapper">
							<a class="carousel-control-thumbnails text-center" role="button" onclick="$('.carousel-thumbnails').scrollLeft(-200)">
						    	<span class="fa fa-2x fa-angle-left"></span>
							</a>
							<a class="carousel-control-thumbnails carousel-control-right-thumbnails text-center" role="button" onclick="$('.carousel-thumbnails').scrollLeft(200)"> 
						    	<span class="fa fa-2x fa-angle-right"></span>
							</a>
							<ol class="carousel-thumbnails">
								<li class="img-carousel-thumbnail active" data-target="#productCarouselIndicators" data-slide-to="0" th:data-img="${product.mainImage}">
									<img class="img-thumbnail" th:title="${product.title}" th:alt="${product.title}"
						    			th:src="${product.mainImage} ? @{|${@environment.getProperty('url.images')}/${product.id}/${product.article}/${product.mainImage}|} : ${@environment.getProperty('url.no-image')}">
								</li>
								<li class="img-carousel-thumbnail" th:each="img,iter : ${product.images}"
									data-target="#productCarouselIndicators" th:data-slide-to="${iter.index + 1}" th:data-img="${img}">
									<img class="img-thumbnail" th:title="${product.title}" th:alt="${product.title}"
						    			th:src="@{|${@environment.getProperty('url.images')}/${product.id}/${product.article}/${img}|}">
								</li>
							</ol>
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="row align-items-center">
						<div class="col-12">
							<p class="small"><span class="font-weight-bold">[[#{msg.common.productArticle}]]:</span> [[${product.article}]]</p>
						</div>
						<div class="col-12">
							<p class="small text-justify" th:utext="${product.description}">Description</p>
						</div>
						<div class="col-12">
							<hr/>
						</div>
						<div class="col-3">
							<div class="h5">
								<span th:each="label : ${product.labels}"
									class="product-label badge w-100"
									th:classappend="|badge-${label.value.value}|">
									[[${label.key}]]
								</span>
							</div>
						</div>
						<div class="col-4 text-center">
							<div class="product-actual-price-block d-none">
								<span class="d-block h1 font-weight-bold">
									<span class="product-actual-price">[[${product.actualPrice}]]</span> [[#{|msg.currency.${appInfo.currency}|}]]
								</span>
								<span class="d-block h4">
									<del><span class="product-price">[[${product.price}]]</span> [[#{|msg.currency.${appInfo.currency}|}]]</del>
								</span>
							</div>
							<div class="product-price-block d-none col-12">
								<span class="d-block h1 font-weight-bold">
									<span class="product-price-label">
										<span class="product-price">[[${product.price}]]</span> [[#{|msg.currency.${appInfo.currency}|}]]
									</span>
								</span>
							</div>
						</div>
						<div class="col-5">
							<div class="row">
								<div class="col-12">
									<button id="addToCartButton" type="button" onclick="addToCart('ADD_PRODUCT', getProductId())" class="btn btn-success btn-block">
							 			<span class="fa fa-cart-plus fa-lg"></span>
							 			<span th:text="#{msg.common.addToCart}">Add to cart</span>
							 		</button>
							 		<button id="singleClickBuyButton" type="button" onclick="showQuickOrderModal()" class="btn btn-link text-success btn-block">
							 			<span class="fa fa-cart-arrow-down fa-lg"></span>
							 			<span th:text="#{msg.common.singleClickOrder}">Single click order</span>
							 		</button>
						 		</div>
					 		</div>
						</div>
						<div class="col-12">
							<hr/>
						</div>
						<div th:unless="${#maps.isEmpty(product.optionValues)}" class="col-12">
							<th:block th:if="${#maps.size(product.optionValues) > 1}">
								<div th:each="ov : ${product.optionValues}" class="form-group">
									<label th:for="${ov.key}"><strong th:text="${ov.key}">Option name</strong></label>
							   		<select th:data-option-name="${ov.key}" class="product-option form-control" onchange="onProductOptionChanged(this)">
							   			<option th:each="v : ${ov.value}" th:value="${v.key}" th:text="${v.value}">Option value</option>
							      	</select>
								</div>
							</th:block>
							
							<th:block th:if="${#maps.size(product.optionValues) == 1}">
								<div th:each="ov : ${product.optionValues}" class="form-group">
									<span class="font-weight-bold">[[${ov.key}]]</span>
									<div th:each="v,iter : ${ov.value}" class="form-check">
										<input class="form-check-input" type="radio"
											th:data-option-name="${ov.key}"
											th:name="${ov.key}"
											th:id="|${ov.key}${v.value}|"
											th:value="${v.key}"
											th:checked="${iter.index == 0}"
											onchange="onProductOptionChanged(this)">
									  	<label class="form-check-label font-italic" th:for="|${ov.key}${v.value}|">
									    	[[${v.value}]]
									  	</label>
									</div>
						      	</div>
					    	</th:block>
					    	<hr/>
						</div>
					</div>
					<div class="row">
						<div class="col-12">
							<th:block th:replace="pages/products/details/product-details-panels :: extra"></th:block>
						</div>
						<div class="col-12">
							<hr/>
						</div>
						<div class="col-12">
							<th:block th:replace="pages/products/details/product-details-panels :: shipping"></th:block>
						</div>
						<div class="col-12">
							<hr/>
						</div>
						<div class="col-12">
							<th:block th:replace="pages/products/details/product-details-panels :: payments"></th:block>
						</div>
						<div class="col-12">
							<hr/>
						</div>
					</div>
				</div>
			</div>
			<div class="col-12">
				<hr/>
			</div>
			<div class="col-12">
				<th:block th:if="${#request.getAttribute('currentDevice').mobile}">
					<th:block th:replace="pages/products/details/product-details-extra-panel.mobile :: product-details-extra-panel(product = ${product})"></th:block>			
				</th:block>
				<th:block th:unless="${#request.getAttribute('currentDevice').mobile}">
					<th:block th:replace="pages/products/details/product-details-extra-panel :: product-details-extra-panel(product = ${product})"></th:block>
				</th:block>
			</div>
			<form id="addToCartForm" th:action="${@environment.getProperty('url.cart.state')}" method="POST">
				<div id="addToCartModal"></div>
			</form>
			<th:block th:replace="pages/products/details/quick-order-modal :: quick-order-modal(product = ${product})"></th:block>
			<th:block th:replace="pages/products/details/quick-order-success-modal :: quick-order-success-modal(product = ${product})"></th:block>
		</div>
	</th:block>	
		
	<th:block layout:fragment="page_scripts">
		<script th:inline="javascript">
			/*<![CDATA[*/
			var product = /*[[${product}]]*/ null;
			var addCommentSuccessMessage = '[[#{msg.common.thanksForComment}]]';
			var addCommentValidationMessages = {
				name: {
					required: '[[#{msg.error.comment.name.required}]]',
					maxlength: '[[#{msg.error.comment.name.tooLong}]]',
				},
				email: {
					required: '[[#{msg.error.common.email.required}]]',
					email: '[[#{msg.error.common.email.invalid}]]',
					maxlength: '[[#{msg.error.common.email.tooLong}]]'
				},
				comment: {
					required: '[[#{msg.error.comment.comment.required}]]',
					maxlength: '[[#{msg.error.comment.comment.tooLong}]]'
				},
				productRating: {
					required: '[[#{msg.error.comment.rating.required}]]',
					min: '[[#{msg.error.comment.rating.invalid}]]',
					max: '[[#{msg.error.comment.rating.invalid}]]',
				}
			}
			
			var quickOrderValidationMessages = {
				phone: {
					required: '[[#{msg.error.contactPhoneRequired}]]',
					maxlength: '[[#{msg.error.contactPhoneIsTooLong}]]'
				},
				fullName: {
					maxlength: '[[#{msg.error.fullNameIsTooLong}]]'
				},
				address: {
					maxlength: '[[#{msg.error.addressIsTooLong}]]'
				}
			}
			/*]]>*/
		</script>
		<script th:src="@{/js/products/product-common.js}"></script>
		<script th:src="@{/js/products/product-details.js}"></script>
	</th:block>
</body>
</html>